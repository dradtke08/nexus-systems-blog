<!-- Nexus Systems Custom Scripts -->
<script>
  (function() {
    // Run immediately and on DOMContentLoaded
    function disableImageExpand() {
      var images = document.querySelectorAll('#post-list img, #post-list .preview-img, #post-list .shimmer');
      images.forEach(function(el) {
        // Remove all click handlers by cloning
        var clone = el.cloneNode(true);
        if (el.parentNode) {
          el.parentNode.replaceChild(clone, el);
        }
      });

      // Also intercept at the post-list level
      var postList = document.getElementById('post-list');
      if (postList) {
        postList.addEventListener('click', function(e) {
          var img = e.target.closest('img, .preview-img, .shimmer');
          if (img) {
            e.stopImmediatePropagation();
            // Navigate to the post instead
            var link = e.target.closest('a.post-preview');
            if (link) {
              window.location.href = link.href;
            }
          }
        }, true);
      }
    }

    // Run on DOMContentLoaded
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', disableImageExpand);
    } else {
      disableImageExpand();
    }

    // Also run after a short delay to catch late-binding JS
    setTimeout(disableImageExpand, 500);
    setTimeout(disableImageExpand, 1000);
  })();
</script>
